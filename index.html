<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Bernardo - Completo</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background: #0f172a; color: white; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .container { background: #1e293b; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); text-align: center; width: 500px; max-height: 90vh; overflow-y: auto; }
        input { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: 1px solid #334155; background: #0f172a; color: white; box-sizing: border-box; }
        .btn-login, .botao { background: #38bdf8; color: #0f172a; border: none; width: 100%; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px; }
        #tela-cadastro, #tela-hub, #tela-financas, #tela-estudos, #tela-admin { display: none; }
        table { width: 100%; margin-top: 20px; border-collapse: collapse; background: #0f172a; border-radius: 8px; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid #334155; font-size: 0.75rem; }
        th { color: #38bdf8; background: #1e293b; }
        .btn-acao { background: none; border: none; cursor: pointer; font-size: 1.1rem; margin: 0 5px; }
    </style>
</head>
<body>

    <div id="tela-login" class="container"> 
        <h1>Login</h1>
        <input type="text" id="usuario" placeholder="Usu√°rio">
        <input type="password" id="senha" placeholder="Senha">
        <button class="btn-login" onclick="fazerLogin()">Entrar</button>
        <button class="botao" onclick="abrirTela('tela-cadastro')" style="background: #64748b; color: white;">Cadastre-se</button>
    </div>

    <div id="tela-admin" class="container">
        <h1>Gerenciamento de Usu√°rios</h1>
        <table id="tabela-admin">
            <thead>
                <tr>
                    <th>Usu√°rio</th>
                    <th>Senha</th>
                    <th>A√ß√£o</th>
                </tr>
            </thead>
            <tbody id="corpo-tabela-admin"></tbody>
        </table>
        <button class="btn-login" style="background: #f87171; color: white; margin-top: 20px;" onclick="logout()">Sair</button>
    </div>

    <div id="tela-hub" class="container">
        <h1>Ol√°, <span id="nome-user-hub"></span>!</h1>
        <button class="botao" onclick="abrirTela('tela-financas')" style="background: #22c55e; color: white;">üí∞ Minhas Finan√ßas</button>
        <button class="botao" onclick="abrirTela('tela-estudos')" style="background: #a855f7; color: white;">üìö Meus Estudos</button>
        <button class="btn-login" style="background: #f87171; color: white; margin-top: 30px;" onclick="logout()">Sair</button>
    </div>

    <div id="tela-estudos" class="container">
        <h1>üìö Gest√£o de Estudos</h1>
        <div style="background: #0f172a; padding: 15px; border-radius: 10px;">
            <input type="text" id="estudo-materia" placeholder="Nome da Mat√©ria (ex: Matem√°tica)">
            <button class="botao" onclick="adicionarMateria()" style="background: #a855f7; color: white;">Cadastrar Mat√©ria</button>
        </div>
        
        <table id="tabela-estudos">
            <thead>
                <tr>
                    <th>Mat√©ria</th>
                    <th>A√ß√£o</th>
                </tr>
            </thead>
            <tbody id="corpo-estudos"></tbody>
        </table>
        <button class="btn-login" style="margin-top: 20px;" onclick="abrirTela('tela-hub')">Voltar ao Menu</button>
    </div>

    <div id="tela-financas" class="container">
        <h1>üí∞ Finan√ßas</h1>
        <input type="text" id="fin-local" placeholder="Local">
        <input type="number" id="fin-valor" placeholder="Valor">
        <button class="botao" onclick="adicionarGasto()" style="background: #22c55e; color: white;">Adicionar</button>
        <div id="lista-financas-resumo"></div>
        <button class="btn-login" onclick="abrirTela('tela-hub')">Voltar</button>
    </div>

    <script>
    let usuariosDB = JSON.parse(localStorage.getItem('usuarios')) || { "admin": "123", "bernardo": "120624" };
    let estudosDB = JSON.parse(localStorage.getItem('estudos_v1')) || {};
    let financasDB = JSON.parse(localStorage.getItem('financas_v8')) || {};
    let usuarioLogado = "";

    function abrirTela(id) {
        document.querySelectorAll('.container').forEach(c => c.style.display = 'none');
        document.getElementById(id).style.display = 'block';
        if (id === 'tela-admin') desenharAdmin();
        if (id === 'tela-estudos') desenharEstudos();
    }

    function fazerLogin() {
        const u = document.getElementById('usuario').value.toLowerCase().trim();
        const s = document.getElementById('senha').value;
        if (usuariosDB[u] && usuariosDB[u] === s) {
            usuarioLogado = u;
            if (u === "admin") {
                abrirTela('tela-admin');
            } else {
                document.getElementById('nome-user-hub').innerText = u;
                abrirTela('tela-hub');
            }
        } else {
            alert("Acesso negado!");
        }
    }

    // --- LOGICA DE ADMIN ---
    function desenharAdmin() {
        const corpo = document.getElementById('corpo-tabela-admin');
        corpo.innerHTML = "";
        for (let user in usuariosDB) {
            corpo.innerHTML += `
                <tr>
                    <td>${user}</td>
                    <td>${usuariosDB[user]}</td>
                    <td><button onclick="alterarSenhaAdmin('${user}')">‚úèÔ∏è</button></td>
                </tr>
            `;
        }
    }

    window.alterarSenhaAdmin = function(user) {
        const nova = prompt(`Nova senha para ${user}:`);
        if (nova) {
            usuariosDB[user] = nova;
            localStorage.setItem('usuarios', JSON.stringify(usuariosDB));
            desenharAdmin();
        }
    }

    // --- LOGICA DE ESTUDOS ---
    function adicionarMateria() {
        const materia = document.getElementById('estudo-materia').value;
        if (!materia) return alert("Digite o nome da mat√©ria!");

        if (!estudosDB[usuarioLogado]) estudosDB[usuarioLogado] = [];
        estudosDB[usuarioLogado].push(materia);
        
        localStorage.setItem('estudos_v1', JSON.stringify(estudosDB));
        document.getElementById('estudo-materia').value = "";
        desenharEstudos();
    }

    function desenharEstudos() {
        const corpo = document.getElementById('corpo-estudos');
        corpo.innerHTML = "";
        const minhasMaterias = estudosDB[usuarioLogado] || [];
        
        minhasMaterias.forEach((m, index) => {
            corpo.innerHTML += `
                <tr>
                    <td>${m}</td>
                    <td><button onclick="removerMateria(${index})">üóëÔ∏è</button></td>
                </tr>
            `;
        });
    }

    window.removerMateria = function(index) {
        if (confirm("Deseja remover esta mat√©ria?")) {
            estudosDB[usuarioLogado].splice(index, 1);
            localStorage.setItem('estudos_v1', JSON.stringify(estudosDB));
            desenharEstudos();
        }
    }

    function logout() { location.reload(); }
    </script>
</body>
</html>